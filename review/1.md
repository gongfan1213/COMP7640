根据《L13-Crash Recovery.pdf》文档内容，COMP7640课程第13讲《崩溃恢复》的完整知识点解析如下：

一、崩溃恢复的核心目标

保障ACID特性

原子性（Atomicity）：确保未完成事务（如文档中的T4和T5）全部回滚。持久性（Durability）：已提交事务（如T1和T2）的修改必须永久生效。
恢复场景

系统崩溃后需根据日志恢复事务状态（如转账事务T在崩溃时未完成，需回滚部分修改）。


二、基于日志的恢复方法
1. 延迟修改（Deferred-Modification）

日志记录内容：

<T start>：事务开始标记。<T, X, V_new>：记录事务T对数据项X的新值（如<T, A, 950>表示A修改为950）。  <T commit>：事务提交标记。
恢复规则：

已提交事务：扫描日志并应用所有<T, X, V_new>到磁盘（如文档中T1的修改需持久化）。未提交事务：忽略日志记录，重新执行事务（如T4需从头执行）。
缺点：
需全量扫描日志（如处理T1和T2的所有记录），效率低。
2. 立即修改（Immediate-Modification）

日志记录内容：
<T, X, V_old>：记录数据项X的旧值（如<T, A, 1000>用于回滚）。  恢复规则：

已提交事务：无需操作（修改已写入磁盘）。未提交事务：根据<T, X, V_old>回滚（如将A从950恢复为1000）。  
优点：
允许即时写入磁盘，减少日志扫描开销。

三、关键示例与对比



场景
延迟修改
立即修改




崩溃前提交（如T1） 
扫描日志并应用V_new到磁盘
无需操作（修改已持久化）


崩溃前未提交（如T4）
丢弃日志并重新执行事务
根据V_old回滚修改




四、考试重点与答题技巧

典型题型

给定时序日志（如<T1 start>, <T1, X, 10>, <T2 start>, <T2 commit>），判断如何恢复。对比两种方法的日志内容和恢复流程差异。
答题步骤：

步骤1：检查事务是否含<T commit>标记。步骤2：

延迟修改：仅处理已提交事务的V_new。立即修改：回滚未提交事务的V_old。



五、与其他章节的关联

事务管理（L12）：崩溃恢复是实现ACID中原子性和持久性的关键。存储管理（L7）：日志需持久化存储（如磁盘），与缓冲区管理策略相关。

六、文档未覆盖内容

检查点（Checkpointing）：未提及如何通过检查点减少恢复时间。ARIES算法：未涉及现代数据库常用的复杂恢复算法。
注：考试可能仅要求掌握基础日志恢复方法，建议结合课件中的转账示例（初始值A=1000, B=2000）练习恢复流程。
