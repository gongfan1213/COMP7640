
以下是基于课件内容的**ACID特性**详细复习总结，结合关键示例与实现原理：

---

### **1. Atomicity（原子性）**
#### **定义**  
- 事务的所有操作必须**全部完成**或**全部不执行**（全有或全无）。  
- **核心目标**：避免部分执行导致的数据不一致。  

#### **示例**（PPT Page 12-13）  
- **转账事务**：从账户A转50美元到账户B：  
  ```plaintext
  1. read(A)
  2. A = A - 50
  3. write(A)
  4. read(B)
  5. B = B + 50
  6. write(B)
  ```  
  - 若步骤3成功后系统崩溃，原子性要求**撤销已执行的步骤1-3**，恢复A的原始值。  

#### **实现机制**  
- **日志记录**（PPT Page 9-11）：  
  - **延迟修改**：记录意图（新值），提交后批量更新。  
  - **立即修改**：记录旧值，崩溃时撤销未提交事务。  
- **恢复策略**：  
  - 未提交事务 ⇒ **Undo**（撤销）。  

---

### **2. Consistency（一致性）**
#### **定义**  
- 事务执行后，数据库必须满足**预定义的约束条件**（如主键、外键、业务规则）。  
- **用户责任**：通过约束（如`CHECK`）和触发器定义规则。  

#### **示例**（PPT Page 10, 12）  
- **约束**：银行账户余额不能为负。  
  - 若事务执行后`A = -50`（违反约束），则必须**回滚整个事务**。  

#### **依赖关系**  
- 原子性、隔离性和持久性是实现一致性的**手段**。  

---

### **3. Isolation（隔离性）**
#### **定义**  
- 并发事务的执行**不应相互干扰**，每个事务感觉自己是系统中唯一运行的事务。  
- **核心问题**：避免脏读、不可重复读、幻读。  

#### **示例**（PPT Page 13, 20-21）  
- **并发转账冲突**：  
  - 事务T1和T2同时读取A=100，分别执行`A = A + 50`，若不加锁，最终A=150（应为200）。  
  - **错误结果**：因未隔离导致更新丢失。  

#### **实现机制**  
- **锁协议**（PPT Page 23-26）：  
  - **共享锁（S）**：读操作，允许多事务并发读。  
  - **排他锁（X）**：写操作，独占数据项。  
- **两阶段锁（2PL）**（PPT Page 30-33）：  
  - **增长阶段**：仅获取锁。  
  - **收缩阶段**：仅释放锁。  
  - **作用**：保证可串行化调度。  

---

### **4. Durability（持久性）**
#### **定义**  
- 已提交事务的修改必须**永久保存**，即使系统崩溃。  

#### **示例**（PPT Page 11, 14）  
- 转账事务提交后，即使磁盘损坏，A=950和B=2050的结果必须**可恢复**。  

#### **实现机制**  
- **日志持久化**（PPT Page 7-8）：  
  - 提交前先将日志写入磁盘（Write-Ahead Logging, WAL）。  
- **恢复策略**：  
  - 已提交事务 ⇒ **Redo**（重做）。  

---

### **ACID的关联与挑战**
#### **关联性**  
- **原子性 + 持久性** ⇒ 崩溃恢复（PPT Page 14）。  
- **隔离性** ⇒ 并发控制（PPT Page 15）。  
- **一致性** ⇒ 三者共同保障的结果。  

#### **典型问题**  
1. **如何保证原子性？**  
   - 通过日志记录事务操作，崩溃时撤销未提交事务。  
2. **隔离性为何重要？**  
   - 防止并发事务导致数据竞争（如PPT Page 20的更新丢失）。  
3. **持久性如何实现？**  
   - 日志优先写入磁盘，确保提交后修改不丢失。  

---

### **考试常见题型**
1. **判断题**：  
   - “两阶段锁协议完全避免了死锁。”（✗ 错误，2PL可能导致死锁，需额外处理。）  
2. **场景分析**：  
   - 给出事务调度，判断是否满足ACID（如PPT Page 20的并发转账错误）。  
3. **对比题**：  
   - 延迟修改 vs. 立即修改的恢复策略差异（PPT Page 9-11 vs. 20-21）。  

---

### **记忆技巧**
- **ACID口诀**：  
  - **A**ll（原子性：全做或全不做）  
  - **C**orrect（一致性：约束必须满足）  
  - **I**ndependent（隔离性：事务互不干扰）  
  - **D**urable（持久性：提交即永久）  

结合课件中的**转账示例**和**锁协议流程图**（如PPT Page 33）理解更直观！
